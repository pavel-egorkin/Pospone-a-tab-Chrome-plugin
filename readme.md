# BackLater — snooze tabs, get them back exactly on time

**Chromium extension** that hides the current tab and re‑opens it at the date/time you choose — when you’ll actually have time to process it.

---

## Why use it
- “Read‑later” lists pile up. Browser tabs pile up even harder. **BackLater** puts pages **out of sight** and **back in your flow** at the right moment.
- Your future self shouldn’t hunt for the right tab — it should reappear **precisely** when needed.

---

## Features at a glance
- **Quick Snooze popup** with fast presets
- **Pick a Date** calendar with time selector.
- **Recurring (Repeatedly)** schedules (e.g., every Wed 9:00).
- **Postponed Tabs list** to view, search, reschedule, wake now, 
- **Optional notification** (click to open) and optional **toolbar badge** with count.
- **Configurable Keyboard shortcuts** for power use.
- Do not work in Incognito mode
- Manifest V3, minimal permissions, privacy‑first.

> **Design constraint**: On the 3×3 tiles view there are **no icons** except the **Settings** gear. In the Sleeping Tabs window the **floating +** button creates a new to‑do tab.

---

## Color & UI spec ()
High‑contrast grayscale palette. No chroma; rely on typography, spacing, and subtle elevation.

- **Accent / Interactive:** Gray 900 `#0F172A` (hover: Gray 800 `#1F2937`, active: Gray 700 `#374151`)
- **Primary text:** Gray 900 `#0F172A`
- **Secondary text:** Gray 600 `#4B5563`
- **Background:** `#F9FAFB`
- **Surface (cards/modals):** `#FFFFFF`
- **Surface alt:** `#F3F4F6`
- **Borders / dividers:** `#E5E7EB`
- **Focus ring:** `rgba(17, 24, 39, .35)` (3px outline)

### Icon
- **Glyph:** Tab + timer.
- **SVG asset:** [`tab-timer-icon.svg`](assets/tab-timer-icon.svg)

---

## Flows

### 1) Quick Snooze popup
Open from the toolbar button or via keyboard shortcut.

**Grid (text‑only tiles):**
- **Later Today**  
- **This Evening**  
- **Tomorrow**  
- **Next Weekend**  
- **Next Week**  
- **In a Month**  
- **Someday**  
- **Repeatedly**  
- **Pick a Date**

**Footer:**
- **Sleeping Tabs** (opens list window)
- **Settings** (small gear icon, right‑aligned)

**Rules & microcopy**
- Subtitles may show the resolved time, e.g., “Later Today — in 3h”.
- Disable a preset if it would land in the past (e.g., “This Evening” after cut‑off).

---

### 2) Pick a Date
**Modal includes:**
- **Calendar** (month switcher)
- **Time dropdown** in 30‑min steps (customizable default)
- Primary button **Snooze**

**Validation:**
- Cannot pick past date/time.
- Normalizes to local timezone; stores UTC.

---

### 3) Repeatedly (recurring)
**Modal includes:**
- Frequency: **Daily / Weekly / Monthly**
- For **Weekly**: weekday checkboxes
- **At this hour** dropdown
- **Snooze** to create the recurrence

**Behavior:**
- Each recurrence re‑opens the tab and then schedules the next run.
- You can **Pause**, **Edit**, or **Delete** a recurrence from the Sleeping Tabs list.

---

### 4) Sleeping Tabs list
Window with two sections: **Upcoming** and **History**.

- Grouping: **Today**, **Tomorrow**, **This Week**, **Later**
- Row: favicon, title, scheduled time, actions **Wake**, **Reschedule**, **Delete**
- **Search** by title/URL
- **FAB +** → **New to‑do tab** (opens a blank tab or notes URL, then snooze it)

---

### 5) Notifications & badge (optional)
- When a tab wakes: desktop notification; click focuses the tab.
- **Toolbar badge**: Hidden / 1–9 / 9+ count.

---

### 6) Keyboard shortcuts (editable at `chrome://extensions/shortcuts`)
**Suggested defaults:**
- **Snooze active tab:** `Alt+S`
- **Open Sleeping Tabs list:** `Alt+L`
- **Repeat last snooze:** `Alt+Shift+S`
- **New to‑do tab:** `Alt+1`

---

## Settings
### General
- **Wake‑up notification** (enable/disable)

### Presets
- **Tomorrow starts at** `08:00`
- **Evening starts at** `19:00`
- **Week starts on** Mon/Sun
- **Weekend starts on** Sat/Fri
- **Later Today** offset (e.g., `+3h`)
- **Someday** default (e.g., `+3 months`)
- **Default time** for date picker


- **Danger zone**: Delete all snoozes

---

## Architecture (MV3, vanilla JS)
- **Service worker** (background): schedules, alarms, storage, notifications.
- **Popup UI**: presets grid, routes to date/recurring modals.
- **Options page**: settings & data management.
- **Sleeping Tabs page**: list, search, bulk actions.
- **Offscreen document** (optional) to play sounds.

### Data model
```ts
export type Snooze = {
  id: string;                 // uuid
  url: string;
  title?: string;
  createdAt: string;          // ISO UTC
  fireAt: string;             // ISO UTC
  windowType: 'normal'|'incognito';
  pinned?: boolean;
  note?: string;              // optional user note
  recurrenceId?: string;      // link if generated by a recurrence
};

export type Recurrence = {
  id: string;                 // uuid
  kind: 'daily'|'weekly'|'monthly';
  daysOfWeek?: number[];      // 0..6, Sun..Sat (for weekly)
  hour: number;               // 0..23
  minute: number;             // 0..59
  url: string;
  title?: string;
  nextFireAt: string;         // computed UTC
  paused?: boolean;
};

## Scheduling

- Use `chrome.alarms.create(id, { when })` with UTC timestamps.
- On alarm: validate URL, open in last-active window; if none, create a new window; focus the tab.

## Storage strategy

- Default: `chrome.storage.local`.
- Optional: **Sync** mode for small sets via `chrome.storage.sync` (100KB quota; toggle in Settings).

## Permissions (minimal)

```json
{
  "permissions": ["tabs", "storage", "alarms", "notifications", "contextMenus"],
  "host_permissions": ["<all_urls>"],
  "optional_host_permissions": ["<all_urls>"],
  "action": { "default_popup": "popup.html" }
}
```

- Prefer `optional_host_permissions` — request on first use.
- Avoid content scripts unless strictly needed.

## Security notes

- Treat cross-component messages as untrusted; verify structure and origin.
- Sanitize all user inputs in Settings and custom dates.
- Store only URL + title + schedule; no page content.
- Enterprise policy hooks: disable notifications, enforce storage scope, block hostnames.

## Manifest (skeleton)

```json
{
  "manifest_version": 3,
  "name": "BackLater",
  "version": "0.1.0",
  "description": "Hide a tab now. Get it back exactly when you want.",
  "action": { "default_title": "Snooze this tab", "default_popup": "popup.html" },
  "background": { "service_worker": "sw.js" },
  "options_page": "options.html",
  "icons": { "16": "icons/16.png", "48": "icons/48.png", "128": "icons/128.png" },
  "permissions": ["tabs", "storage", "alarms", "notifications", "contextMenus"],
  "optional_host_permissions": ["<all_urls>"]
}
```

## Compliance checklist

- Adhere to MV3 best practices: https://developer.chrome.com/docs/webstore/best-practices#manifest_version_3  
- Request minimal permissions; prefer optional host permissions.  
- Validate & sanitize all inputs (settings, custom dates).  
- Verify `runtime.onMessage` senders; ignore unexpected origins.  
- Test across latest Chromium variants (Chrome, Edge, Brave, Vivaldi, Arc).

## Development

- **Stack:** vanilla JS (optionally Vite/ESBuild for bundling; no Node APIs in SW).
- **Run:** Load unpacked at `chrome://extensions` → Developer mode → Load unpacked.
- **Shortcuts:** configure at `chrome://extensions/shortcuts`.
- **Testing matrix:** Chrome, Edge, Brave, Arc, Vivaldi; light/dark; normal/incognito.

## Accessibility

- Full keyboard support in popup (arrow keys move the grid; `Enter` confirms).
- Focus outlines visible; contrasts meet WCAG AA.
- Screen-reader labels for tiles and actions.
- Time & date respect user locale (`Intl.DateTimeFormat`).

## Privacy

- No analytics.
- All data stays in chrome.storage;

## Known limitations
- Clearing extension data removes schedules.
- Do not work in Incognito mode.

## FAQ

- What happens if the browser is closed at the scheduled time? 
The alarm fires at next startup; BackLater opens the tab immediately.
- Do I need host permissions for every site? 
Only when capturing the current tab’s URL/title; request once on first use.

License

- MIT

